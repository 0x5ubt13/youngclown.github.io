<!DOCTYPE html><html lang="lang"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="nohup이란"><meta name="keywords" content><meta name="author" content="bymin"><meta name="copyright" content="bymin"><title>nohup이란 | 젊은광대 기술블로그</title><link rel="shortcut icon" href="../../../melody-favicon.ico"><link rel="stylesheet" href="../../../css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#행의-극복"><span class="toc-number">1.</span> <span class="toc-text">행의 극복</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#참조"><span class="toc-number"></span> <span class="toc-text">참조</span></a></li></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="../../../img/avatar.png"></div><div class="author-info__name text-center">bymin</div><div class="author-info__description text-center">잘정리하자</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="../../../archives"><span class="pull-left">Articles</span><span class="pull-right">109</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="../../../index.html">젊은광대 기술블로그</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">nohup이란</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-10-11</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>가끔 crontab 에 등록된 shell script 가 동작을 하지 않고 에러가 났을 경우,<br>서버내에서 다시 실행해야할때, nohup 을 씁니다.</p>
<p>nohup이란 리눅스, 유닉스에서 쉘스크립트파일을 데몬형태로 실행시키는 프로그램으로, 터미널 세션이 끊겨도 실행을 멈추지 않고 동작하도록 합니다.<br>shell script 를 실행하고 터미널을 종료하면 프로세스 또한 종료되므로,<br>터미널 세션을 끊겨도 사용해야할 경우에 사용합니다.</p>
<p>보통 명령어는 이렇습니다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ nohup shell.sh &amp;</span><br><span class="line">$ nohup sh -- ./shell.sh &amp;</span><br></pre></td></tr></table></figure>
<p>실제 full 경로를 입력하거나 해당 경로에 가서, ./shell 을 실행합니다.<br>종료하는 방법은 강제로 프로세스를 kill 하는 방법밖에 없습니다. (kill -9 PID)</p>
<p>참고로 위와 같이 nohup과 &amp;을 같이 쓰는 형태로 암기하고 있었는데,<br>&amp;는 프로세스를 실행할 때 백그라운드에서 동작하도록 만드는 명령어로 비슷하지만 다른 명령어입니다.</p>
<p>nohup 으로 실행하면 hang-up signal 이 와도 동작하기 때문에 터미널 연결이 끊어져도 실행을 멈추지 않습니다.<br>&amp; 으로만 실행해도 터미널이 끊어져도 실행이 멈추지는 않는 데,<br>&amp; 은 백그라운드로 돌린다는 의미이며, 기본적으로는 nohup 이 아닐 경우 터미널이 끊어지면 실행도 끊어집니다.<br>하지만 요즘 옵션에 nohup 과 같은 동작을 하게 설정이 되어 있어서 &amp; 만으로도 nohup 과 같은 동작을 보인다고 합니다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nohup shell.sh &gt; /dev/null</span><br></pre></td></tr></table></figure>
<p>그래서 위와같이 &amp; 대신에 &gt; /dev/null 을 더 자주 쓰게 됩니다.<br>/dev/null 은 주로 불필요한 출력 스트림을 버리는 곳으로 사용됩니다.<br>/dev/null 을 사용하지 않을 경우, nohup.out 이라는 파일이 호출한 위치에 파일을 생성시키는데,<br>해당 파일을 생성하지 않게 합니다.</p>
<h2 id="행의-극복"><a href="#행의-극복" class="headerlink" title="행의 극복"></a>행의 극복</h2><p>nohup으로 백그라운드 처리된 작업들은 원격 SSH 세션을 로그오프할 때 일반적으로 이들의 종료를 막기 위해 사용되며, 이 상황에서 발생할 수 있는 또 다른 문제는 ssh가 로그오프(행)을 거부하는 것인데, 그 이유는 백그라운드 작업들에 대한 데이터 손실을 거부하기 때문이다. 이 문제는 3개의 모든 입출력 스트림을 리다이렉션 처리함으로써 극복할 수 있다고 합니다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nohup ./myprogram &gt; foo.out 2&gt; foo.err &lt; /dev/null &amp;</span><br></pre></td></tr></table></figure>
<p>SSH 세션을 닫으면 무조건 의존 프로세스들에 HUP 신호를 보내지 않게 된다. 이는 의사 터미널의 할당 여부에 따라 달라진다고 하는데,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">program &lt; /dev/null program</span><br></pre></td></tr></table></figure>
<p>형태일 때,<br>file descriptor 0 즉 STDIN을 통해 입력인수(옵션에 입력 매개 변수가 있거나 입력 파일이 될 수 있음)를 취하는 것을 의미하는데,<br>/dev/null은 아무것도 포함되어 있지 않으므로, 읽을 때 EOF (End of File)에 알릴 것이므로 /dev/null에서 입력을받는 프로그램은 기본적으로 아무 것도 입력 인수로 리디렉션하지 않습니다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alias start=&apos;nohup java -jar healthcheck.jar /tmp 2&gt;&gt; /dev/null &gt;&gt; /dev/null &amp;&apos;</span><br></pre></td></tr></table></figure>
<p>/tmp 란 폴더를 두어서 별도의 로그관리를 하겠다는 의미이나 에러로그를 /dev/null 에 받게 하기 때문에,<br>결국 /tmp 폴더에는 별다른 로그가 쌓이지 않게 됩니다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alias start=&apos;nohup java -jar healthcheck.jar &gt;&gt; /dev/null &amp;&apos;</span><br></pre></td></tr></table></figure>
<p>만약 이렇게 한다면 jar 파일 자체의 모든 out 스트림을 /dev/null 에 보내기 때문에 , 아예 동작을 하지 않거나 한번만 동작하고 더이상 실행이 안될 수 있습니다.<br>(nohup을 했기 때문에 프로세스는 계속 떠있습니다. ㅠㅜ)</p>
<hr>
<h1 id="참조"><a href="#참조" class="headerlink" title="참조"></a>참조</h1><hr>
<ul>
<li><p><a href="https://zetawiki.com/wiki//dev/null" rel="external nofollow noopener noreferrer" target="_blank">/dev/null</a></p>
</li>
<li><p><a href="https://ko.wikipedia.org/wiki/Nohup" rel="external nofollow noopener noreferrer" target="_blank">행의극복</a></p>
</li>
</ul>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined" rel="external nofollow noopener noreferrer" target="_blank">bymin</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://youngclown.github.io/2018/10/2018-10-12-noup/">https://youngclown.github.io/2018/10/2018-10-12-noup/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noopener noreferrer" target="_blank">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"></div><nav id="pagination"><div class="prev-post pull-left"><a href="../2018-10-15-lamda_01/"><i class="fa fa-chevron-left">  </i><span>람다와 스트림</span></a></div><div class="next-post pull-right"><a href="../2018-10-08-Scouter_APM/"><span>Scouter APM 개발환경 구성하기</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2019 By bymin</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io" rel="external nofollow noopener noreferrer" target="_blank"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" rel="external nofollow noopener noreferrer" target="_blank"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="../../../js/utils.js?version=1.6.1"></script><script src="../../../js/fancybox.js?version=1.6.1"></script><script src="../../../js/sidebar.js?version=1.6.1"></script><script src="../../../js/copy.js?version=1.6.1"></script><script src="../../../js/fireworks.js?version=1.6.1"></script><script src="../../../js/transition.js?version=1.6.1"></script><script src="../../../js/scroll.js?version=1.6.1"></script><script src="../../../js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script></body></html>